@(stack: Option[String], stage: Option[String], app: Option[String], amis: List[Either[String, AMI]])

@import views.html.fragments.{ssaAmiForm, formatAmi, heading}

@main("Instance AMIs") {
    @heading("AMIs in use")
    <div class="container">
        <p>
            @stack.map { stack =>
                <span class="chip">@stack</span>
            }
            @stage.map { stage =>
                <span class="chip">@stage</span>
            }
            @app.map { app =>
                <span class="chip">@app</span>
            }
        </p>
        <div class="row">
            @for((amiOrError, i) <- amis.zipWithIndex) {
                @if((i % 3) == 0 && i > 0) {
                </div>
        <div class="row">
        }
            <div class="col m4">
                @amiOrError match {
                    case Left(err) => {
                        <div class="ami-badge card-panel grey darken-3 center-align white-text">
                            <img src="/assets/images/ami-error.png" alt="AMI" class="ami-icon z-depth-2">
                            @err
                        </div>
                    }
                    case Right(ami) => {
                        @formatAmi(ami)
                    }
                }
            </div>
        }
        </div>
        @ssaAmiForm(stack, stage, app)
    </div>
}
